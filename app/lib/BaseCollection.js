define("BaseCollection",["jquery","underscore","backbone","PaginationModel","Pagination","localStorage"],function(t,i,e){var n,o,a,s;n=t("backbone"),a=t("PaginationModel"),s=t("Pagination"),o=n.Collection.extend({constructor:function(t){this.options=t||{},n.Collection.apply(this,arguments)},_initialize:function(){debug("2.BaseCollection._initialize"),this._baseUrl=this.url,this.options.pagination&&!this.paginationModel&&(this.paginationModel=new a)},parse:function(t){return this._parsePagination(t),this.paginationModel&&(this._parseUrl(this.paginationModel),this._paginationRender()),t.attributes.data},_parseUrl:function(t){debug("7.BaseCollection._parseUrl");var i=1,e=16;if(t&&t.get("pageSize")&&(e=t.get("pageSize"),i=t.get("page")),"function"!=typeof this.url){var n="";Est.isEmpty(this._itemId)||(n="/"+this._itemId),this.url=this._baseUrl+n+"?page="+i+"&pageSize="+e}},_parsePagination:function(t){debug("6.BaseCollection._parsePagination"),t.attributes=t.attributes||{page:1,per_page:10,count:10},this.paginationModel&&(this.paginationModel.set("page",t.attributes.page),this.paginationModel.set("pageSize",t.attributes.per_page),this.paginationModel.set("count",t.attributes.count))},_paginationRender:function(){var t=this;this.pagination?this.pagination.render():this.pagination=new s({model:t.paginationModel})},_load:function(t,i,e){debug("4.BaseCollection._load"),this._parseUrl(e);var n=Est.promise;return new n(function(e){return t.fetch({success:function(){debug("before"),e(t),i.collection._reset(),debug("collection reset end"),i._empty()}})})},_setItemId:function(t){this._itemId=t,debug("根据ID查列表"+this._itemId)},_empty:function(){if(debug("BaseCollection._empty"),this.collection)for(var t=this.collection.length;t>-1;)this.collection.remove(this.collection[t]),t--}}),e.exports=o});