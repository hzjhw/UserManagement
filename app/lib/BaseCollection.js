define("BaseCollection",["jquery","underscore","backbone","PaginationModel","Pagination","localStorage"],function(e,t,i){var n,a,o,s;n=e("backbone"),o=e("PaginationModel"),s=e("Pagination"),a=n.Collection.extend({_initialize:function(){debug("2.BaseCollection._initialize"),this.paginationModel||(this.paginationModel=new o)},parse:function(e){return this._parsePagination(e),this.paginationModel&&(this._parseUrl(this.paginationModel),this._paginationRender()),e.attributes.data},_parseUrl:function(e){debug("7.BaseCollection._parseUrl");var t=1,i=5e3;if(e&&e.get("pageSize")&&(i=e.get("pageSize"),t=e.get("page")),"function"!=typeof this.url){var n="";Est.isEmpty(this.itemId)||(n="/"+this.itemId),this.url=this.url.substring(0,this.url.indexOf("?")>-1?this.url.lastIndexOf("?"):this.url.length)+n+"?page="+t+"&pageSize="+i}},_parsePagination:function(e){debug("6.BaseCollection._parsePagination"),e.attributes=e.attributes||{page:1,per_page:10,count:10},this.paginationModel&&(this.paginationModel.set("page",e.attributes.page),this.paginationModel.set("pageSize",e.attributes.per_page),this.paginationModel.set("count",e.attributes.count))},_paginationRender:function(){var e=this;this.pagination?this.pagination.render():this.pagination=new s({model:e.paginationModel})},_load:function(e,t,i){debug("4.BaseCollection._load"),"undefined"!=typeof i&&this._parseUrl(i);var n=Est.promise;return new n(function(i){return e.fetch({success:function(){debug("before"),i(e),t.collection._reset(),debug("collection reset end"),t._empty()}})})},_empty:function(){if(debug("BaseCollection._empty"),this.collection)for(var e=this.collection.length;e>-1;)this.collection.remove(this.collection[e]),e--}}),i.exports=a});